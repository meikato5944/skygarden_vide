<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/common :: head('構成要素編集 - Skygarden')}"></head>
<body>
    <!-- Sidebar -->
    <nav th:replace="~{fragments/common :: sidebar}"></nav>
    
    <!-- Header (Mobile) -->
    <nav th:replace="~{fragments/common :: header}"></nav>
    
    <!-- Offcanvas Menu (Mobile) -->
    <div th:replace="~{fragments/common :: offcanvas}"></div>
    
    <main>
        <div class="flex-grow-1 d-flex justify-content-center align-items-center p-4 sky-content">
            <div class="w-100">
                <h2 class="text-center mb-3">構成要素入稿画面</h2>
                <div class="card border-warning rounded sky-bg-1">
                    <div class="card-body">
                        <form id="contentform" name="contentform" action="/webadmin/update_post" method="POST">
                            <!-- delete -->
                            <div th:if="${id != '' and id != null}" class="sky-Content-delete mb-2">
                                <a class="btn btn-warning sky-Content-delete-item sky-bg-2 ms-auto" data-bs-toggle="modal" data-bs-target="#deleteModal">
                                    <img th:src="@{/common/image/trash.svg}" alt="delete" />
                                </a>
                            </div>
                            <input type="hidden" id="published" name="published" value="1" />
                            
                            <!-- element color select -->
                            <div class="mb-3 sky-input-pulldown">
                                <label for="elementcolor" class="sky-form-label fw-bold ms-1">type</label>
                                <select class="form-select form-select-lg border-warning" aria-label=".form-select-lg example" th:style="'background-color: ' + ${elementcolor}" id="elementcolor" name="elementcolor" th:utext="${colorOutput}"></select>
                            </div>
                            
                            <!-- title -->
                            <div class="mb-3">
                                <label for="title" class="sky-form-label fw-bold ms-1">title</label>
                                <input type="text" class="form-control sky-input" id="title" name="title" th:value="${title}" placeholder="Enter title" required />
                                <div class="ms-2 invalid-feedback"></div>
                            </div>
                            
                            <!-- content -->
                            <div class="mb-3">
                                <label for="content" class="sky-form-label fw-bold ms-1">content</label>
                                <textarea class="form-control border-warning sky-input sky-input-content" id="content" name="content" rows="10" placeholder="Enter content" th:text="${contentStr}"></textarea>
                            </div>
                            
                            <!-- url -->
                            <div class="mb-3">
                                <label for="url" class="sky-form-label fw-bold ms-1">url</label>
                                <input type="text" class="form-control sky-input" id="url" name="url" th:value="${url}" placeholder="Enter url" required />
                                <div class="ms-2 invalid-feedback">urlの入力に誤りがあります</div>
                            </div>
                            
                            <!-- Save button -->
                            <div class="text-center">
                                <button type="button" class="btn btn-warning w-100 mb-2 mt-5 sky-submit sky-bg-2" data-bs-toggle="modal" data-bs-target="#submitModal">
                                    Save
                                </button>
                            </div>
                            
                            <input type="hidden" name="id" th:value="${id}" />
                            <input type="hidden" name="type" value="element" />
                        </form>
                        
                        <!-- Delete form -->
                        <form id="deleteform" name="deleteform" action="/webadmin/delete_post" method="POST">
                            <input type="hidden" name="id" id="deleteId" th:value="${id}" />
                            <input type="hidden" name="mode" value="element" />
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Submit Modal -->
    <div th:replace="~{fragments/common :: submit-modal}"></div>

    <!-- Delete Modal -->
    <div th:replace="~{fragments/common :: delete-modal}"></div>

    <!-- Footer -->
    <footer th:replace="~{fragments/common :: footer}"></footer>
    
    <script>
        // フォームを送信
        function submitForm() {
            var form = document.getElementById('contentform');
            if (form) {
                form.submit();
            }
        }
        
        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            // Submit Modal - 登録ボタン
            var submitModalBtn = document.getElementById('submitModalBtn');
            if (submitModalBtn) {
                submitModalBtn.addEventListener('click', function() {
                    submitForm();
                });
            }
            
            // Delete Modal - 削除ボタン
            var deleteModalBtn = document.getElementById('deleteModalBtn');
            if (deleteModalBtn) {
                deleteModalBtn.addEventListener('click', function() {
                    var deleteForm = document.getElementById('deleteform');
                    if (deleteForm) {
                        deleteForm.submit();
                    }
                });
            }
        });
    </script>
</body>
</html>
