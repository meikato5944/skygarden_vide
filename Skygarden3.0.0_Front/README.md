# Skygarden Frontend

Skygardenのフロントエンドシステムです。ReactとTypeScriptを使用したSPA（Single Page Application）で、コンテンツ管理、ユーザー管理などの機能を提供します。

## 概要

Skygardenは、コンテンツ管理システム（CMS）のフロントエンドアプリケーションです。直感的なUIでコンテンツ、テンプレート、構成要素の作成・編集・削除、ユーザー管理を行うことができます。

## 技術スタック

- **フレームワーク**: React 19.0.0
- **言語**: TypeScript 4.9.5
- **ルーティング**: React Router 7.1.3
- **ビルドツール**: Create React App
- **主要ライブラリ**:
  - React DOM
  - jQuery 3.7.1（一部の機能で使用）
  - Axios（HTTP通信）

## システム構成

### ディレクトリ構成

```
src/
├── App.tsx                    # アプリケーションのメインコンポーネント
├── index.tsx                  # エントリーポイント
├── types.ts                   # TypeScript型定義
├── pages/                     # ページコンポーネント
│   ├── List.tsx              # コンテンツ一覧ページ
│   ├── Content.tsx           # コンテンツ編集ページ
│   ├── Login.tsx             # ログインページ
│   ├── User.tsx              # ユーザー管理ページ
│   ├── UserList.tsx           # ユーザー一覧ページ
│   └── Setting.tsx           # 設定ページ
├── components/               # 共通コンポーネント
│   ├── common/               # 共通コンポーネント
│   │   ├── Header.tsx        # ヘッダーコンポーネント
│   │   ├── Footer.tsx        # フッターコンポーネント
│   │   ├── Modal.tsx         # モーダルコンポーネント
│   │   ├── button/           # ボタンコンポーネント
│   │   └── input/            # 入力コンポーネント
│   ├── content/              # コンテンツ関連コンポーネント
│   ├── list/                 # 一覧関連コンポーネント
│   └── user/                 # ユーザー関連コンポーネント
├── layouts/                  # レイアウトコンポーネント
│   ├── Layout.tsx            # 共通レイアウト
│   └── ListControl.tsx       # 一覧制御レイアウト
├── contexts/                 # React Context
│   └── AuthContext.tsx       # 認証コンテキスト
├── routes/                   # ルーティング
│   └── PrivateRoute.tsx      # プライベートルート
└── utils/                    # ユーティリティ
    └── commonPrc.tsx         # 共通処理
```

## 主要機能

### 1. コンテンツ管理

#### コンテンツ一覧
- **一覧表示**: コンテンツ、テンプレート、構成要素などの一覧を表示
- **ソート機能**: 更新日時、ID、タイトル、URLでソート可能
- **ページネーション**: 20件ずつページ分割表示
- **新規作成**: 各タイプのコンテンツを新規作成

#### コンテンツ編集
- **基本情報入力**: タイトル、URL、ヘッダー、コンテンツ本文の入力
- **テンプレート選択**: 既存のテンプレートを選択
- **スケジュール設定**: 公開・非公開の日時を設定
- **公開フラグ**: 即座に公開するかどうかを設定
- **プレビュー機能**: 編集内容をプレビュー表示
- **バリデーション**: URL形式、日時形式、URL重複をチェック

#### テンプレート編集
- **構成要素の管理**: テンプレートに使用する構成要素を追加・削除・並び替え
- **構成要素選択**: モーダルから構成要素を選択
- **コンテンツ部分の配置**: コンテンツ部分を任意の位置に配置

#### 構成要素編集
- **色選択**: 設定画面で定義された色から選択

### 2. ユーザー管理

#### ユーザー一覧
- **一覧表示**: 全ユーザーの一覧を表示（管理者のみ）
- **ソート機能**: ID、ユーザー名でソート可能
- **ページネーション**: 20件ずつページ分割表示

#### ユーザー編集
- **基本情報入力**: ユーザー名、パスワード、メールアドレスの入力
- **管理者権限**: 管理者フラグの設定
- **バリデーション**: 必須項目のチェック

### 3. 認証機能

#### ログイン
- **認証**: ユーザー名とパスワードでログイン
- **エラーハンドリング**: ログイン失敗時のエラー表示
- **セッション管理**: ログイン状態をセッションで管理

#### 認証ガード
- **プライベートルート**: 認証が必要なページへのアクセス制御
- **自動リダイレクト**: 未認証時はログインページへリダイレクト

### 4. 設定管理

#### 色設定
- **色要素の追加**: 要素名と色コードを設定
- **色要素の削除**: 不要な色要素を削除
- **設定の保存**: 設定をデータベースに保存

### 5. UI/UX機能

#### レスポンシブデザイン
- **PC版**: サイドメニュー形式のナビゲーション
- **SP版**: オフキャンバスメニュー形式のナビゲーション

#### 共通コンポーネント
- **モーダル**: 確認ダイアログ、削除確認など
- **入力フィールド**: テキスト入力、パスワード入力など
- **ボタン**: 保存ボタン、新規作成ボタンなど

## ページ構成

### 公開ページ

- `/login` - ログインページ

### 認証が必要なページ

- `/` - コンテンツ一覧ページ
- `/content` - コンテンツ編集ページ
- `/user-list` - ユーザー一覧ページ（管理者のみ）
- `/user` - ユーザー管理ページ（管理者のみ）
- `/setting` - 設定ページ

## 状態管理

### 認証状態

`AuthContext`を使用してアプリケーション全体で認証状態を管理しています。

```typescript
const { isAuth } = useAuth();
```

### ローカル状態

各コンポーネントで`useState`を使用してローカル状態を管理しています。

## API連携

### ベースURL

環境変数`REACT_APP_API_BASE_URL`でAPIのベースURLを設定します。

デフォルト: `http://localhost:8080/webadmin`

### 認証

すべてのAPIリクエストで`credentials: "include"`を設定してセッションクッキーを送信します。

### 主要なAPI呼び出し

- `fetchListData()`: 一覧データの取得
- `getSessionData()`: セッションデータの取得

## セットアップ

### 前提条件

- Node.js 16以上
- npm または yarn

### インストール

```bash
# 依存関係のインストール
npm install
```

### 環境変数

`.env`ファイルを作成して環境変数を設定:

```env
REACT_APP_API_BASE_URL=http://localhost:8080/webadmin
```

### 開発サーバーの起動

```bash
npm start
```

アプリケーションは `http://localhost:3000` で起動します。

### ビルド

```bash
# 本番用ビルド
npm run build
```

## 開発

### プロジェクト構造

- `src/`: ソースコード
- `public/`: 静的ファイル
- `package.json`: 依存関係とスクリプト

### コードスタイル

- TypeScriptの型定義を活用
- コンポーネントは関数コンポーネントで記述
- コメントは日本語で記述

### 主要な型定義

```typescript
// コンテンツ一覧の結果
type ListResult = {
  id: string;
  title: string;
  url: string;
  // ...
};

// ユーザー一覧の結果
type UserListResult = {
  id: string;
  name: string;
  admin: string;
  // ...
};
```

## ブラウザサポート

- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）

## ライセンス

このプロジェクトは内部使用を目的としています。
